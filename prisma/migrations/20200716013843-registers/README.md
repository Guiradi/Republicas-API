# Migration `20200716013843-registers`

This migration has been generated by Guiradi at 7/16/2020, 1:38:43 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `sempapp`.`Republica` (
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
`id` varchar(191) NOT NULL  ,
`logo` varchar(191)   ,
`name` varchar(191) NOT NULL  ,
`status` ENUM('DELETED', 'ACTIVE') NOT NULL DEFAULT 'ACTIVE' ,
`updatedAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `sempapp`.`Room` (
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
`id` varchar(191) NOT NULL  ,
`name` varchar(191) NOT NULL  ,
`price` Decimal(65,30) NOT NULL DEFAULT 0.0 ,
`republicaId` varchar(191) NOT NULL ,
`status` ENUM('DELETED', 'ACTIVE') NOT NULL DEFAULT 'ACTIVE' ,
`updatedAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `sempapp`.`User` (
`createdAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
`email` varchar(191) NOT NULL  ,
`id` varchar(191) NOT NULL  ,
`name` varchar(191)   ,
`nickname` varchar(191)   ,
`password` varchar(191) NOT NULL  ,
`photo` varchar(191)   ,
`republicaId` varchar(191) NOT NULL ,
`role` ENUM('USER', 'ADMIN') NOT NULL DEFAULT 'USER' ,
`roomId` varchar(191) NOT NULL ,
`situation` ENUM('MORADOR', 'EXMORADOR') NOT NULL DEFAULT 'MORADOR' ,
`status` ENUM('DELETED', 'ACTIVE') NOT NULL DEFAULT 'ACTIVE' ,
`updatedAt` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ,
    PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `User.email` ON `sempapp`.`User`(`email`)

ALTER TABLE `sempapp`.`Room` ADD FOREIGN KEY (`republicaId`) REFERENCES `sempapp`.`Republica`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `sempapp`.`User` ADD FOREIGN KEY (`roomId`) REFERENCES `sempapp`.`Room`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `sempapp`.`User` ADD FOREIGN KEY (`republicaId`) REFERENCES `sempapp`.`Republica`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

DROP TABLE `sempapp`.`_migration`;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200716013843-registers
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,67 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "mysql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+enum Role {
+  USER
+  ADMIN
+}
+
+enum Status {
+  DELETED
+  ACTIVE
+}
+
+enum HomeSituation {
+  MORADOR
+  EXMORADOR
+}
+
+model Republica {
+  id        String   @id @default(uuid())
+  name      String
+  logo      String?
+  rooms     Room[]
+  users     User[]
+  status    Status   @default(ACTIVE)
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now()) @updatedAt
+}
+
+model Room {
+  id          String    @id @default(uuid())
+  name        String
+  price       Float     @default(0.0)
+  users       User[]
+  republicaId String
+  republica   Republica @relation(fields: [republicaId], references: [id])
+  status      Status    @default(ACTIVE)
+  createdAt   DateTime  @default(now())
+  updatedAt   DateTime  @default(now()) @updatedAt
+}
+
+model User {
+  id          String        @id @default(uuid())
+  name        String?
+  nickname    String?
+  photo       String?
+  email       String        @unique
+  password    String
+  role        Role          @default(USER)
+  situation   HomeSituation @default(MORADOR)
+  roomId      String
+  room        Room          @relation(fields: [roomId], references: [id])
+  republicaId String
+  republica   Republica     @relation(fields: [republicaId], references: [id])
+  status      Status        @default(ACTIVE)
+  createdAt   DateTime      @default(now())
+  updatedAt   DateTime      @default(now()) @updatedAt
+}
```


